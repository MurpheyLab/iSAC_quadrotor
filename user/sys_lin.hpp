 /* Copyright (C) 2017 Emmanouil Tzorakoleftherakis
    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.
    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.
    You should have received a copy of the GNU General Public License
    along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */

#ifndef SYS_LIN_HPP
#define SYS_LIN_HPP

namespace sac {

  //[ Linearizations of the system defined as a class
  // USER SPECIFIED:
  class sys_lin {
  
  public:
    //sys_lin( ) :  g_(9.81) , h_(1) {  }

    void A( const state_type & x, const state_type & u, 
	    Eigen::Matrix< double, xlen, xlen > & Amat ) {
				
		Amat(0,6) = 1.0;
		Amat(1,7) = 1.0;
		Amat(2,8) = 1.0;
		Amat(3,9) = 1.0;
		Amat(4,10) = 1.0;
		Amat(5,11)= 1.0;
		Amat(6,3) = (k_quad*(cos(x[3])*sin(x[5])-cos(x[5])*sin(x[3])*sin(x[4]))*(u[0]+u[1]+u[2]+u[3]))/m;
		Amat(6,4) = (k_quad*cos(x[3])*cos(x[4])*cos(x[5])*(u[0]+u[1]+u[2]+u[3]))/m;
		Amat(6,5) = (k_quad*(cos(x[5])*sin(x[3])-cos(x[3])*sin(x[4])*sin(x[5]))*(u[0]+u[1]+u[2]+u[3]))/m;
		Amat(7,3) = -(k_quad*(cos(x[3])*cos(x[5])+sin(x[3])*sin(x[4])*sin(x[5]))*(u[0]+u[1]+u[2]+u[3]))/m;
		Amat(7,4) = (k_quad*cos(x[3])*cos(x[4])*sin(x[5])*(u[0]+u[1]+u[2]+u[3]))/m;
		Amat(7,5) = (k_quad*(sin(x[3])*sin(x[5])+cos(x[3])*cos(x[5])*sin(x[4]))*(u[0]+u[1]+u[2]+u[3]))/m;
		Amat(8,3) = -(k_quad*cos(x[4])*sin(x[3])*(u[0]+u[1]+u[2]+u[3]))/m;
		Amat(8,4) = -(k_quad*cos(x[3])*sin(x[4])*(u[0]+u[1]+u[2]+u[3]))/m;
		Amat(9,3) = (sin(x[4])*(Iyy*cos(x[3])*sin(x[3])*2.0-Izz*cos(x[3])*sin(x[3])*2.0)*(-b*u[0]+b*u[1]-b*u[2]+b*u[3]-Ixx*sin(x[4]*2.0)*x[10]*x[11]*(1.0/2.0)+Iyy*sin(x[4]*2.0)*x[10]*x[11]*(1.0/2.0)+Ixx*cos(x[4])*x[9]*x[10]*(1.0/2.0)+Iyy*cos(x[4])*x[9]*x[10]*(1.0/2.0)-Izz*cos(x[4])*x[9]*x[10]*(1.0/2.0)-Iyy*pow(cos(x[3]),2.0)*cos(x[4])*x[9]*x[10]+Izz*pow(cos(x[3]),2.0)*cos(x[4])*x[9]*x[10]+Iyy*cos(x[3])*sin(x[3])*sin(x[4])*(x[10]*x[10])*(1.0/2.0)-Izz*cos(x[3])*sin(x[3])*sin(x[4])*(x[10]*x[10])*(1.0/2.0)-Iyy*cos(x[3])*pow(cos(x[4]),2.0)*sin(x[3])*x[9]*x[11]-Iyy*pow(cos(x[3]),2.0)*cos(x[4])*sin(x[4])*x[10]*x[11]+Izz*cos(x[3])*pow(cos(x[4]),2.0)*sin(x[3])*x[9]*x[11]+Izz*pow(cos(x[3]),2.0)*cos(x[4])*sin(x[4])*x[10]*x[11]))/(Iyy*Izz*(pow(sin(x[4]),2.0)-1.0))+((Ixx*Iyy*cos(x[3])*sin(x[3])*pow(sin(x[4]),2.0)*2.0-Ixx*Izz*cos(x[3])*sin(x[3])*pow(sin(x[4]),2.0)*2.0)*(-k_quad*l*u[1]+k_quad*l*u[3]+Ixx*cos(x[4])*x[10]*x[11]*(1.0/2.0)))/(Ixx*Iyy*Izz*(pow(sin(x[4]),2.0)-1.0))-(sin(x[4])*(Iyy-Iyy*pow(sin(x[3]),2.0)+Izz*pow(sin(x[3]),2.0))*(Iyy*pow(cos(x[3]),2.0)*sin(x[4])*(x[10]*x[10])*(1.0/2.0)-Izz*pow(cos(x[3]),2.0)*sin(x[4])*(x[10]*x[10])*(1.0/2.0)-Iyy*pow(sin(x[3]),2.0)*sin(x[4])*(x[10]*x[10])*(1.0/2.0)+Izz*pow(sin(x[3]),2.0)*sin(x[4])*(x[10]*x[10])*(1.0/2.0)-Iyy*pow(cos(x[3]),2.0)*pow(cos(x[4]),2.0)*x[9]*x[11]+Izz*pow(cos(x[3]),2.0)*pow(cos(x[4]),2.0)*x[9]*x[11]+Iyy*pow(cos(x[4]),2.0)*pow(sin(x[3]),2.0)*x[9]*x[11]-Izz*pow(cos(x[4]),2.0)*pow(sin(x[3]),2.0)*x[9]*x[11]+Iyy*cos(x[3])*cos(x[4])*sin(x[3])*x[9]*x[10]*2.0-Izz*cos(x[3])*cos(x[4])*sin(x[3])*x[9]*x[10]*2.0+Iyy*cos(x[3])*cos(x[4])*sin(x[3])*sin(x[4])*x[10]*x[11]*2.0-Izz*cos(x[3])*cos(x[4])*sin(x[3])*sin(x[4])*x[10]*x[11]*2.0))/(Iyy*Izz*(pow(sin(x[4]),2.0)-1.0))+(sin(x[4])*cos(x[3]*2.0)*(Iyy*(1.0/2.0)-Izz*(1.0/2.0))*(k_quad*l*u[0]-k_quad*l*u[2]-Iyy*sin(x[3]*2.0)*x[9]*x[10]*(1.0/2.0)+Izz*sin(x[3]*2.0)*x[9]*x[10]*(1.0/2.0)-Iyy*cos(x[4])*x[9]*x[11]*(1.0/2.0)+Izz*cos(x[4])*x[9]*x[11]*(1.0/2.0)+Iyy*pow(cos(x[3]),2.0)*cos(x[4])*x[9]*x[11]-Izz*pow(cos(x[3]),2.0)*cos(x[4])*x[9]*x[11]-Iyy*cos(x[3])*sin(x[3])*sin(x[4])*x[10]*x[11]*(1.0/2.0)+Izz*cos(x[3])*sin(x[3])*sin(x[4])*x[10]*x[11]*(1.0/2.0))*2.0)/(Iyy*Izz*cos(x[4]))-(sin(x[4])*sin(x[3]*2.0)*(Iyy*(1.0/2.0)-Izz*(1.0/2.0))*(Iyy*cos(x[3]*2.0)*x[9]*x[10]-Izz*cos(x[3]*2.0)*x[9]*x[10]+Iyy*pow(cos(x[3]),2.0)*sin(x[4])*x[10]*x[11]*(1.0/2.0)-Izz*pow(cos(x[3]),2.0)*sin(x[4])*x[10]*x[11]*(1.0/2.0)-Iyy*pow(sin(x[3]),2.0)*sin(x[4])*x[10]*x[11]*(1.0/2.0)+Izz*pow(sin(x[3]),2.0)*sin(x[4])*x[10]*x[11]*(1.0/2.0)+Iyy*cos(x[3])*cos(x[4])*sin(x[3])*x[9]*x[11]*2.0-Izz*cos(x[3])*cos(x[4])*sin(x[3])*x[9]*x[11]*2.0))/(Iyy*Izz*cos(x[4]));
		Amat(9,4) = (sin(x[3]*2.0)*(Iyy*(1.0/2.0)-Izz*(1.0/2.0))*(k_quad*l*u[0]-k_quad*l*u[2]-Iyy*sin(x[3]*2.0)*x[9]*x[10]*(1.0/2.0)+Izz*sin(x[3]*2.0)*x[9]*x[10]*(1.0/2.0)-Iyy*cos(x[4])*x[9]*x[11]*(1.0/2.0)+Izz*cos(x[4])*x[9]*x[11]*(1.0/2.0)+Iyy*pow(cos(x[3]),2.0)*cos(x[4])*x[9]*x[11]-Izz*pow(cos(x[3]),2.0)*cos(x[4])*x[9]*x[11]-Iyy*cos(x[3])*sin(x[3])*sin(x[4])*x[10]*x[11]*(1.0/2.0)+Izz*cos(x[3])*sin(x[3])*sin(x[4])*x[10]*x[11]*(1.0/2.0)))/(Iyy*Izz)-((-k_quad*l*u[1]+k_quad*l*u[3]+Ixx*cos(x[4])*x[10]*x[11]*(1.0/2.0))*(Ixx*Iyy*cos(x[4])*sin(x[4])*2.0-Iyy*Izz*cos(x[4])*sin(x[4])*2.0-Ixx*Iyy*cos(x[4])*pow(sin(x[3]),2.0)*sin(x[4])*2.0+Ixx*Izz*cos(x[4])*pow(sin(x[3]),2.0)*sin(x[4])*2.0))/(Ixx*Iyy*Izz*(pow(sin(x[4]),2.0)-1.0))+(sin(x[4])*(Iyy-Iyy*pow(sin(x[3]),2.0)+Izz*pow(sin(x[3]),2.0))*(Ixx*sin(x[4])*x[9]*x[10]*(1.0/2.0)+Iyy*sin(x[4])*x[9]*x[10]*(1.0/2.0)-Izz*sin(x[4])*x[9]*x[10]*(1.0/2.0)+Ixx*cos(x[4]*2.0)*x[10]*x[11]-Iyy*cos(x[4]*2.0)*x[10]*x[11]-Iyy*pow(cos(x[3]),2.0)*sin(x[4])*x[9]*x[10]+Izz*pow(cos(x[3]),2.0)*sin(x[4])*x[9]*x[10]+Iyy*pow(cos(x[3]),2.0)*pow(cos(x[4]),2.0)*x[10]*x[11]-Izz*pow(cos(x[3]),2.0)*pow(cos(x[4]),2.0)*x[10]*x[11]-Iyy*pow(cos(x[3]),2.0)*pow(sin(x[4]),2.0)*x[10]*x[11]+Izz*pow(cos(x[3]),2.0)*pow(sin(x[4]),2.0)*x[10]*x[11]-Iyy*cos(x[3])*cos(x[4])*sin(x[3])*(x[10]*x[10])*(1.0/2.0)+Izz*cos(x[3])*cos(x[4])*sin(x[3])*(x[10]*x[10])*(1.0/2.0)-Iyy*cos(x[3])*cos(x[4])*sin(x[3])*sin(x[4])*x[9]*x[11]*2.0+Izz*cos(x[3])*cos(x[4])*sin(x[3])*sin(x[4])*x[9]*x[11]*2.0))/(Iyy*Izz*(pow(sin(x[4]),2.0)-1.0))-(cos(x[4])*(Iyy-Iyy*pow(sin(x[3]),2.0)+Izz*pow(sin(x[3]),2.0))*(-b*u[0]+b*u[1]-b*u[2]+b*u[3]-Ixx*sin(x[4]*2.0)*x[10]*x[11]*(1.0/2.0)+Iyy*sin(x[4]*2.0)*x[10]*x[11]*(1.0/2.0)+Ixx*cos(x[4])*x[9]*x[10]*(1.0/2.0)+Iyy*cos(x[4])*x[9]*x[10]*(1.0/2.0)-Izz*cos(x[4])*x[9]*x[10]*(1.0/2.0)-Iyy*pow(cos(x[3]),2.0)*cos(x[4])*x[9]*x[10]+Izz*pow(cos(x[3]),2.0)*cos(x[4])*x[9]*x[10]+Iyy*cos(x[3])*sin(x[3])*sin(x[4])*(x[10]*x[10])*(1.0/2.0)-Izz*cos(x[3])*sin(x[3])*sin(x[4])*(x[10]*x[10])*(1.0/2.0)-Iyy*cos(x[3])*pow(cos(x[4]),2.0)*sin(x[3])*x[9]*x[11]-Iyy*pow(cos(x[3]),2.0)*cos(x[4])*sin(x[4])*x[10]*x[11]+Izz*cos(x[3])*pow(cos(x[4]),2.0)*sin(x[3])*x[9]*x[11]+Izz*pow(cos(x[3]),2.0)*cos(x[4])*sin(x[4])*x[10]*x[11]))/(Iyy*Izz*(pow(sin(x[4]),2.0)-1.0))+(sin(x[4])*x[10]*x[11]*(Iyy*Izz+Ixx*Iyy*pow(sin(x[4]),2.0)-Iyy*Izz*pow(sin(x[4]),2.0)-Ixx*Iyy*pow(sin(x[3]),2.0)*pow(sin(x[4]),2.0)+Ixx*Izz*pow(sin(x[3]),2.0)*pow(sin(x[4]),2.0))*(1.0/2.0))/(Iyy*Izz*(pow(sin(x[4]),2.0)-1.0))+(sin(x[4])*sin(x[3]*2.0)*(Iyy*(1.0/2.0)-Izz*(1.0/2.0))*(Iyy*sin(x[4])*x[9]*x[11]*(1.0/2.0)-Izz*sin(x[4])*x[9]*x[11]*(1.0/2.0)-Iyy*pow(cos(x[3]),2.0)*sin(x[4])*x[9]*x[11]+Izz*pow(cos(x[3]),2.0)*sin(x[4])*x[9]*x[11]-Iyy*cos(x[3])*cos(x[4])*sin(x[3])*x[10]*x[11]*(1.0/2.0)+Izz*cos(x[3])*cos(x[4])*sin(x[3])*x[10]*x[11]*(1.0/2.0)))/(Iyy*Izz*cos(x[4]))+(cos(x[4])*pow(sin(x[4]),2.0)*1.0/pow(pow(sin(x[4]),2.0)-1.0,2.0)*(Iyy-Iyy*pow(sin(x[3]),2.0)+Izz*pow(sin(x[3]),2.0))*(-b*u[0]+b*u[1]-b*u[2]+b*u[3]-Ixx*sin(x[4]*2.0)*x[10]*x[11]*(1.0/2.0)+Iyy*sin(x[4]*2.0)*x[10]*x[11]*(1.0/2.0)+Ixx*cos(x[4])*x[9]*x[10]*(1.0/2.0)+Iyy*cos(x[4])*x[9]*x[10]*(1.0/2.0)-Izz*cos(x[4])*x[9]*x[10]*(1.0/2.0)-Iyy*pow(cos(x[3]),2.0)*cos(x[4])*x[9]*x[10]+Izz*pow(cos(x[3]),2.0)*cos(x[4])*x[9]*x[10]+Iyy*cos(x[3])*sin(x[3])*sin(x[4])*(x[10]*x[10])*(1.0/2.0)-Izz*cos(x[3])*sin(x[3])*sin(x[4])*(x[10]*x[10])*(1.0/2.0)-Iyy*cos(x[3])*pow(cos(x[4]),2.0)*sin(x[3])*x[9]*x[11]-Iyy*pow(cos(x[3]),2.0)*cos(x[4])*sin(x[4])*x[10]*x[11]+Izz*cos(x[3])*pow(cos(x[4]),2.0)*sin(x[3])*x[9]*x[11]+Izz*pow(cos(x[3]),2.0)*cos(x[4])*sin(x[4])*x[10]*x[11])*2.0)/(Iyy*Izz)+(1.0/pow(cos(x[4]),2.0)*pow(sin(x[4]),2.0)*sin(x[3]*2.0)*(Iyy*(1.0/2.0)-Izz*(1.0/2.0))*(k_quad*l*u[0]-k_quad*l*u[2]-Iyy*sin(x[3]*2.0)*x[9]*x[10]*(1.0/2.0)+Izz*sin(x[3]*2.0)*x[9]*x[10]*(1.0/2.0)-Iyy*cos(x[4])*x[9]*x[11]*(1.0/2.0)+Izz*cos(x[4])*x[9]*x[11]*(1.0/2.0)+Iyy*pow(cos(x[3]),2.0)*cos(x[4])*x[9]*x[11]-Izz*pow(cos(x[3]),2.0)*cos(x[4])*x[9]*x[11]-Iyy*cos(x[3])*sin(x[3])*sin(x[4])*x[10]*x[11]*(1.0/2.0)+Izz*cos(x[3])*sin(x[3])*sin(x[4])*x[10]*x[11]*(1.0/2.0)))/(Iyy*Izz)+(cos(x[4])*sin(x[4])*1.0/pow(pow(sin(x[4]),2.0)-1.0,2.0)*(-k_quad*l*u[1]+k_quad*l*u[3]+Ixx*cos(x[4])*x[10]*x[11]*(1.0/2.0))*(Iyy*Izz+Ixx*Iyy*pow(sin(x[4]),2.0)-Iyy*Izz*pow(sin(x[4]),2.0)-Ixx*Iyy*pow(sin(x[3]),2.0)*pow(sin(x[4]),2.0)+Ixx*Izz*pow(sin(x[3]),2.0)*pow(sin(x[4]),2.0))*2.0)/(Ixx*Iyy*Izz);
		Amat(9,9) = -(sin(x[4])*(Iyy-Iyy*pow(sin(x[3]),2.0)+Izz*pow(sin(x[3]),2.0))*(Ixx*cos(x[4])*x[10]*(1.0/2.0)+Iyy*cos(x[4])*x[10]*(1.0/2.0)-Izz*cos(x[4])*x[10]*(1.0/2.0)-Iyy*pow(cos(x[3]),2.0)*cos(x[4])*x[10]+Izz*pow(cos(x[3]),2.0)*cos(x[4])*x[10]-Iyy*cos(x[3])*pow(cos(x[4]),2.0)*sin(x[3])*x[11]+Izz*cos(x[3])*pow(cos(x[4]),2.0)*sin(x[3])*x[11]))/(Iyy*Izz*(pow(sin(x[4]),2.0)-1.0))-(sin(x[4])*sin(x[3]*2.0)*(Iyy*(1.0/2.0)-Izz*(1.0/2.0))*(Iyy*sin(x[3]*2.0)*x[10]*(1.0/2.0)-Izz*sin(x[3]*2.0)*x[10]*(1.0/2.0)+Iyy*cos(x[4])*x[11]*(1.0/2.0)-Izz*cos(x[4])*x[11]*(1.0/2.0)-Iyy*pow(cos(x[3]),2.0)*cos(x[4])*x[11]+Izz*pow(cos(x[3]),2.0)*cos(x[4])*x[11]))/(Iyy*Izz*cos(x[4]));
		Amat(9,10) = -(sin(x[4])*(Iyy-Iyy*pow(sin(x[3]),2.0)+Izz*pow(sin(x[3]),2.0))*(Ixx*sin(x[4]*2.0)*x[11]*(-1.0/2.0)+Iyy*sin(x[4]*2.0)*x[11]*(1.0/2.0)+Ixx*cos(x[4])*x[9]*(1.0/2.0)+Iyy*cos(x[4])*x[9]*(1.0/2.0)-Izz*cos(x[4])*x[9]*(1.0/2.0)-Iyy*pow(cos(x[3]),2.0)*cos(x[4])*x[9]+Izz*pow(cos(x[3]),2.0)*cos(x[4])*x[9]+Iyy*cos(x[3])*sin(x[3])*sin(x[4])*x[10]-Izz*cos(x[3])*sin(x[3])*sin(x[4])*x[10]-Iyy*pow(cos(x[3]),2.0)*cos(x[4])*sin(x[4])*x[11]+Izz*pow(cos(x[3]),2.0)*cos(x[4])*sin(x[4])*x[11]))/(Iyy*Izz*(pow(sin(x[4]),2.0)-1.0))-(cos(x[4])*x[11]*(Iyy*Izz+Ixx*Iyy*pow(sin(x[4]),2.0)-Iyy*Izz*pow(sin(x[4]),2.0)-Ixx*Iyy*pow(sin(x[3]),2.0)*pow(sin(x[4]),2.0)+Ixx*Izz*pow(sin(x[3]),2.0)*pow(sin(x[4]),2.0))*(1.0/2.0))/(Iyy*Izz*(pow(sin(x[4]),2.0)-1.0))-(sin(x[4])*sin(x[3]*2.0)*(Iyy*(1.0/2.0)-Izz*(1.0/2.0))*(Iyy*sin(x[3]*2.0)*x[9]*(1.0/2.0)-Izz*sin(x[3]*2.0)*x[9]*(1.0/2.0)+Iyy*cos(x[3])*sin(x[3])*sin(x[4])*x[11]*(1.0/2.0)-Izz*cos(x[3])*sin(x[3])*sin(x[4])*x[11]*(1.0/2.0)))/(Iyy*Izz*cos(x[4]));
		Amat(9,11) = (cos(x[4])*x[10]*(Iyy*Izz+Ixx*Iyy*pow(sin(x[4]),2.0)-Iyy*Izz*pow(sin(x[4]),2.0)-Ixx*Iyy*pow(sin(x[3]),2.0)*pow(sin(x[4]),2.0)+Ixx*Izz*pow(sin(x[3]),2.0)*pow(sin(x[4]),2.0))*(-1.0/2.0))/(Iyy*Izz*(pow(sin(x[4]),2.0)-1.0))+(sin(x[4])*(Iyy-Iyy*pow(sin(x[3]),2.0)+Izz*pow(sin(x[3]),2.0))*(Ixx*sin(x[4]*2.0)*x[10]*(1.0/2.0)-Iyy*sin(x[4]*2.0)*x[10]*(1.0/2.0)+Iyy*cos(x[3])*pow(cos(x[4]),2.0)*sin(x[3])*x[9]+Iyy*pow(cos(x[3]),2.0)*cos(x[4])*sin(x[4])*x[10]-Izz*cos(x[3])*pow(cos(x[4]),2.0)*sin(x[3])*x[9]-Izz*pow(cos(x[3]),2.0)*cos(x[4])*sin(x[4])*x[10]))/(Iyy*Izz*(pow(sin(x[4]),2.0)-1.0))-(sin(x[4])*sin(x[3]*2.0)*(Iyy*(1.0/2.0)-Izz*(1.0/2.0))*(Iyy*cos(x[4])*x[9]*(1.0/2.0)-Izz*cos(x[4])*x[9]*(1.0/2.0)-Iyy*pow(cos(x[3]),2.0)*cos(x[4])*x[9]+Izz*pow(cos(x[3]),2.0)*cos(x[4])*x[9]+Iyy*cos(x[3])*sin(x[3])*sin(x[4])*x[10]*(1.0/2.0)-Izz*cos(x[3])*sin(x[3])*sin(x[4])*x[10]*(1.0/2.0)))/(Iyy*Izz*cos(x[4]));
		Amat(10,3) = (Iyy*b*cos(x[3]*2.0)*u[0]-Iyy*b*cos(x[3]*2.0)*u[1]+Iyy*b*cos(x[3]*2.0)*u[2]-Iyy*b*cos(x[3]*2.0)*u[3]-Izz*b*cos(x[3]*2.0)*u[0]+Izz*b*cos(x[3]*2.0)*u[1]-Izz*b*cos(x[3]*2.0)*u[2]+Izz*b*cos(x[3]*2.0)*u[3]+(Iyy*Iyy)*cos(x[3])*sin(x[3])*sin(x[4])*(x[10]*x[10])+(Izz*Izz)*cos(x[3])*sin(x[3])*sin(x[4])*(x[10]*x[10])-(Iyy*Iyy)*pow(cos(x[3]),3.0)*sin(x[3])*sin(x[4])*(x[10]*x[10])*2.0-(Izz*Izz)*pow(cos(x[3]),3.0)*sin(x[3])*sin(x[4])*(x[10]*x[10])*2.0+(Iyy*Iyy)*pow(cos(x[3]),2.0)*cos(x[4])*x[9]*x[10]*(1.0/2.0)-(Izz*Izz)*pow(cos(x[3]),2.0)*cos(x[4])*x[9]*x[10]*(1.0/2.0)-(Iyy*Iyy)*cos(x[4])*pow(sin(x[3]),2.0)*x[9]*x[10]*(1.0/2.0)+(Izz*Izz)*cos(x[4])*pow(sin(x[3]),2.0)*x[9]*x[10]*(1.0/2.0)+Iyy*k_quad*l*pow(cos(x[3]),2.0)*sin(x[4])*u[1]-Iyy*k_quad*l*pow(cos(x[3]),2.0)*sin(x[4])*u[3]-Izz*k_quad*l*pow(cos(x[3]),2.0)*sin(x[4])*u[1]+Izz*k_quad*l*pow(cos(x[3]),2.0)*sin(x[4])*u[3]-Iyy*k_quad*l*pow(sin(x[3]),2.0)*sin(x[4])*u[1]+Iyy*k_quad*l*pow(sin(x[3]),2.0)*sin(x[4])*u[3]+Izz*k_quad*l*pow(sin(x[3]),2.0)*sin(x[4])*u[1]-Izz*k_quad*l*pow(sin(x[3]),2.0)*sin(x[4])*u[3]+Iyy*Izz*pow(cos(x[3]),3.0)*sin(x[3])*sin(x[4])*(x[10]*x[10])*4.0-Ixx*Iyy*pow(cos(x[3]),2.0)*cos(x[4])*x[9]*x[10]*(1.0/2.0)+Ixx*Izz*pow(cos(x[3]),2.0)*cos(x[4])*x[9]*x[10]*(1.0/2.0)+Ixx*Iyy*cos(x[4])*pow(sin(x[3]),2.0)*x[9]*x[10]*(1.0/2.0)-Ixx*Izz*cos(x[4])*pow(sin(x[3]),2.0)*x[9]*x[10]*(1.0/2.0)+(Iyy*Iyy)*cos(x[3])*pow(cos(x[4]),2.0)*sin(x[3])*x[9]*x[11]-(Iyy*Iyy)*pow(cos(x[3]),2.0)*cos(x[4])*sin(x[4])*x[10]*x[11]*(1.0/2.0)+(Iyy*Iyy)*pow(cos(x[3]),4.0)*cos(x[4])*sin(x[4])*x[10]*x[11]*(1.0/2.0)-(Izz*Izz)*cos(x[3])*pow(cos(x[4]),2.0)*sin(x[3])*x[9]*x[11]+(Izz*Izz)*pow(cos(x[3]),4.0)*cos(x[4])*sin(x[4])*x[10]*x[11]*(1.0/2.0)+(Iyy*Iyy)*cos(x[4])*pow(sin(x[3]),2.0)*sin(x[4])*x[10]*x[11]*(1.0/2.0)-Iyy*Izz*cos(x[3])*sin(x[3])*sin(x[4])*(x[10]*x[10])*2.0-Iyy*k_quad*l*cos(x[3])*cos(x[4])*sin(x[3])*u[0]*2.0+Iyy*k_quad*l*cos(x[3])*cos(x[4])*sin(x[3])*u[2]*2.0+Izz*k_quad*l*cos(x[3])*cos(x[4])*sin(x[3])*u[0]*2.0-Izz*k_quad*l*cos(x[3])*cos(x[4])*sin(x[3])*u[2]*2.0-(Iyy*Iyy)*pow(cos(x[3]),2.0)*cos(x[4])*pow(sin(x[3]),2.0)*sin(x[4])*x[10]*x[11]*(3.0/2.0)-(Izz*Izz)*pow(cos(x[3]),2.0)*cos(x[4])*pow(sin(x[3]),2.0)*sin(x[4])*x[10]*x[11]*(3.0/2.0)+Ixx*Iyy*pow(cos(x[3]),2.0)*cos(x[4])*sin(x[4])*x[10]*x[11]*(1.0/2.0)-Ixx*Izz*pow(cos(x[3]),2.0)*cos(x[4])*sin(x[4])*x[10]*x[11]*(1.0/2.0)+Iyy*Izz*pow(cos(x[3]),2.0)*cos(x[4])*sin(x[4])*x[10]*x[11]*(1.0/2.0)-Iyy*Izz*pow(cos(x[3]),4.0)*cos(x[4])*sin(x[4])*x[10]*x[11]-Ixx*Iyy*cos(x[4])*pow(sin(x[3]),2.0)*sin(x[4])*x[10]*x[11]*(1.0/2.0)+Ixx*Izz*cos(x[4])*pow(sin(x[3]),2.0)*sin(x[4])*x[10]*x[11]*(1.0/2.0)-Iyy*Izz*cos(x[4])*pow(sin(x[3]),2.0)*sin(x[4])*x[10]*x[11]*(1.0/2.0)+Iyy*Izz*pow(cos(x[3]),2.0)*cos(x[4])*pow(sin(x[3]),2.0)*sin(x[4])*x[10]*x[11]*3.0)/(Iyy*Izz*cos(x[4]));
		Amat(10,4) = ((Iyy*Iyy)*pow(cos(x[3]),2.0)*cos(x[4])*(x[10]*x[10])*(-1.0/2.0)+(Iyy*Iyy)*pow(cos(x[3]),4.0)*cos(x[4])*(x[10]*x[10])*(1.0/2.0)-(Izz*Izz)*pow(cos(x[3]),2.0)*cos(x[4])*(x[10]*x[10])*(1.0/2.0)+(Izz*Izz)*pow(cos(x[3]),4.0)*cos(x[4])*(x[10]*x[10])*(1.0/2.0)-(Iyy*Iyy)*cos(x[4])*sin(x[4])*x[9]*x[11]+Iyy*k_quad*l*sin(x[4])*u[0]-Iyy*k_quad*l*sin(x[4])*u[2]+Iyy*Izz*pow(cos(x[3]),2.0)*cos(x[4])*(x[10]*x[10])-Iyy*Izz*pow(cos(x[3]),4.0)*cos(x[4])*(x[10]*x[10])+Iyy*Izz*cos(x[4])*sin(x[4])*x[9]*x[11]+(Iyy*Iyy)*pow(cos(x[3]),3.0)*pow(cos(x[4]),2.0)*sin(x[3])*x[10]*x[11]*(1.0/2.0)+(Izz*Izz)*pow(cos(x[3]),3.0)*pow(cos(x[4]),2.0)*sin(x[3])*x[10]*x[11]*(1.0/2.0)-Iyy*k_quad*l*pow(cos(x[3]),2.0)*sin(x[4])*u[0]+Iyy*k_quad*l*pow(cos(x[3]),2.0)*sin(x[4])*u[2]+Izz*k_quad*l*pow(cos(x[3]),2.0)*sin(x[4])*u[0]-Izz*k_quad*l*pow(cos(x[3]),2.0)*sin(x[4])*u[2]-(Iyy*Iyy)*pow(cos(x[3]),3.0)*sin(x[3])*pow(sin(x[4]),2.0)*x[10]*x[11]*(1.0/2.0)-(Izz*Izz)*pow(cos(x[3]),3.0)*sin(x[3])*pow(sin(x[4]),2.0)*x[10]*x[11]*(1.0/2.0)-(Iyy*Iyy)*cos(x[3])*sin(x[3])*sin(x[4])*x[9]*x[10]*(1.0/2.0)+(Izz*Izz)*cos(x[3])*sin(x[3])*sin(x[4])*x[9]*x[10]*(1.0/2.0)-(Iyy*Iyy)*cos(x[3])*pow(cos(x[4]),2.0)*sin(x[3])*x[10]*x[11]*(1.0/2.0)+(Iyy*Iyy)*pow(cos(x[3]),2.0)*cos(x[4])*sin(x[4])*x[9]*x[11]-(Izz*Izz)*pow(cos(x[3]),2.0)*cos(x[4])*sin(x[4])*x[9]*x[11]+(Iyy*Iyy)*cos(x[3])*sin(x[3])*pow(sin(x[4]),2.0)*x[10]*x[11]*(1.0/2.0)+Iyy*k_quad*l*cos(x[3])*cos(x[4])*sin(x[3])*u[1]-Iyy*k_quad*l*cos(x[3])*cos(x[4])*sin(x[3])*u[3]-Izz*k_quad*l*cos(x[3])*cos(x[4])*sin(x[3])*u[1]+Izz*k_quad*l*cos(x[3])*cos(x[4])*sin(x[3])*u[3]-Iyy*Izz*pow(cos(x[3]),3.0)*pow(cos(x[4]),2.0)*sin(x[3])*x[10]*x[11]+Iyy*Izz*pow(cos(x[3]),3.0)*sin(x[3])*pow(sin(x[4]),2.0)*x[10]*x[11]+Ixx*Iyy*cos(x[3])*sin(x[3])*sin(x[4])*x[9]*x[10]*(1.0/2.0)-Ixx*Izz*cos(x[3])*sin(x[3])*sin(x[4])*x[9]*x[10]*(1.0/2.0)+Ixx*Iyy*cos(x[3])*pow(cos(x[4]),2.0)*sin(x[3])*x[10]*x[11]*(1.0/2.0)-Ixx*Izz*cos(x[3])*pow(cos(x[4]),2.0)*sin(x[3])*x[10]*x[11]*(1.0/2.0)+Iyy*Izz*cos(x[3])*pow(cos(x[4]),2.0)*sin(x[3])*x[10]*x[11]*(1.0/2.0)-Ixx*Iyy*cos(x[3])*sin(x[3])*pow(sin(x[4]),2.0)*x[10]*x[11]*(1.0/2.0)+Ixx*Izz*cos(x[3])*sin(x[3])*pow(sin(x[4]),2.0)*x[10]*x[11]*(1.0/2.0)-Iyy*Izz*cos(x[3])*sin(x[3])*pow(sin(x[4]),2.0)*x[10]*x[11]*(1.0/2.0))/(Iyy*Izz*cos(x[4]))+(1.0/pow(cos(x[4]),2.0)*sin(x[4])*(-(Iyy*Iyy)*pow(cos(x[3]),2.0)*sin(x[4])*(x[10]*x[10])+(Iyy*Iyy)*pow(cos(x[3]),4.0)*sin(x[4])*(x[10]*x[10])-(Izz*Izz)*pow(cos(x[3]),2.0)*sin(x[4])*(x[10]*x[10])+(Izz*Izz)*pow(cos(x[3]),4.0)*sin(x[4])*(x[10]*x[10])+(Iyy*Iyy)*pow(cos(x[4]),2.0)*x[9]*x[11]+Iyy*b*sin(x[3]*2.0)*u[0]-Iyy*b*sin(x[3]*2.0)*u[1]+Iyy*b*sin(x[3]*2.0)*u[2]-Iyy*b*sin(x[3]*2.0)*u[3]-Izz*b*sin(x[3]*2.0)*u[0]+Izz*b*sin(x[3]*2.0)*u[1]-Izz*b*sin(x[3]*2.0)*u[2]+Izz*b*sin(x[3]*2.0)*u[3]+Iyy*Izz*pow(cos(x[3]),2.0)*sin(x[4])*(x[10]*x[10])*2.0-Iyy*Izz*pow(cos(x[3]),4.0)*sin(x[4])*(x[10]*x[10])*2.0-Iyy*Izz*pow(cos(x[4]),2.0)*x[9]*x[11]-Iyy*k_quad*l*cos(x[4])*u[0]*2.0+Iyy*k_quad*l*cos(x[4])*u[2]*2.0-(Iyy*Iyy)*pow(cos(x[3]),2.0)*pow(cos(x[4]),2.0)*x[9]*x[11]+(Izz*Izz)*pow(cos(x[3]),2.0)*pow(cos(x[4]),2.0)*x[9]*x[11]+Iyy*k_quad*l*pow(cos(x[3]),2.0)*cos(x[4])*u[0]*2.0-Iyy*k_quad*l*pow(cos(x[3]),2.0)*cos(x[4])*u[2]*2.0-Izz*k_quad*l*pow(cos(x[3]),2.0)*cos(x[4])*u[0]*2.0+Izz*k_quad*l*pow(cos(x[3]),2.0)*cos(x[4])*u[2]*2.0+(Iyy*Iyy)*cos(x[3])*cos(x[4])*sin(x[3])*x[9]*x[10]-(Izz*Izz)*cos(x[3])*cos(x[4])*sin(x[3])*x[9]*x[10]+(Iyy*Iyy)*pow(cos(x[3]),3.0)*cos(x[4])*sin(x[3])*sin(x[4])*x[10]*x[11]+(Izz*Izz)*pow(cos(x[3]),3.0)*cos(x[4])*sin(x[3])*sin(x[4])*x[10]*x[11]+Iyy*k_quad*l*cos(x[3])*sin(x[3])*sin(x[4])*u[1]*2.0-Iyy*k_quad*l*cos(x[3])*sin(x[3])*sin(x[4])*u[3]*2.0-Izz*k_quad*l*cos(x[3])*sin(x[3])*sin(x[4])*u[1]*2.0+Izz*k_quad*l*cos(x[3])*sin(x[3])*sin(x[4])*u[3]*2.0-Ixx*Iyy*cos(x[3])*cos(x[4])*sin(x[3])*x[9]*x[10]+Ixx*Izz*cos(x[3])*cos(x[4])*sin(x[3])*x[9]*x[10]-(Iyy*Iyy)*cos(x[3])*cos(x[4])*sin(x[3])*sin(x[4])*x[10]*x[11]-Iyy*Izz*pow(cos(x[3]),3.0)*cos(x[4])*sin(x[3])*sin(x[4])*x[10]*x[11]*2.0+Ixx*Iyy*cos(x[3])*cos(x[4])*sin(x[3])*sin(x[4])*x[10]*x[11]-Ixx*Izz*cos(x[3])*cos(x[4])*sin(x[3])*sin(x[4])*x[10]*x[11]+Iyy*Izz*cos(x[3])*cos(x[4])*sin(x[3])*sin(x[4])*x[10]*x[11])*(1.0/2.0))/(Iyy*Izz);
		Amat(10,9) = ((Iyy*Iyy)*pow(cos(x[4]),2.0)*x[11]*(1.0/2.0)-(Iyy*Iyy)*pow(cos(x[3]),2.0)*pow(cos(x[4]),2.0)*x[11]*(1.0/2.0)+(Izz*Izz)*pow(cos(x[3]),2.0)*pow(cos(x[4]),2.0)*x[11]*(1.0/2.0)-Iyy*Izz*pow(cos(x[4]),2.0)*x[11]*(1.0/2.0)+(Iyy*Iyy)*cos(x[3])*cos(x[4])*sin(x[3])*x[10]*(1.0/2.0)-(Izz*Izz)*cos(x[3])*cos(x[4])*sin(x[3])*x[10]*(1.0/2.0)-Ixx*Iyy*cos(x[3])*cos(x[4])*sin(x[3])*x[10]*(1.0/2.0)+Ixx*Izz*cos(x[3])*cos(x[4])*sin(x[3])*x[10]*(1.0/2.0))/(Iyy*Izz*cos(x[4]));
		Amat(10,10) = (-(Iyy*Iyy)*pow(cos(x[3]),2.0)*sin(x[4])*x[10]+(Iyy*Iyy)*pow(cos(x[3]),4.0)*sin(x[4])*x[10]-(Izz*Izz)*pow(cos(x[3]),2.0)*sin(x[4])*x[10]+(Izz*Izz)*pow(cos(x[3]),4.0)*sin(x[4])*x[10]+(Iyy*Iyy)*cos(x[3])*cos(x[4])*sin(x[3])*x[9]*(1.0/2.0)-(Izz*Izz)*cos(x[3])*cos(x[4])*sin(x[3])*x[9]*(1.0/2.0)+Iyy*Izz*pow(cos(x[3]),2.0)*sin(x[4])*x[10]*2.0-Iyy*Izz*pow(cos(x[3]),4.0)*sin(x[4])*x[10]*2.0+(Iyy*Iyy)*pow(cos(x[3]),3.0)*cos(x[4])*sin(x[3])*sin(x[4])*x[11]*(1.0/2.0)+(Izz*Izz)*pow(cos(x[3]),3.0)*cos(x[4])*sin(x[3])*sin(x[4])*x[11]*(1.0/2.0)-Ixx*Iyy*cos(x[3])*cos(x[4])*sin(x[3])*x[9]*(1.0/2.0)+Ixx*Izz*cos(x[3])*cos(x[4])*sin(x[3])*x[9]*(1.0/2.0)-(Iyy*Iyy)*cos(x[3])*cos(x[4])*sin(x[3])*sin(x[4])*x[11]*(1.0/2.0)-Iyy*Izz*pow(cos(x[3]),3.0)*cos(x[4])*sin(x[3])*sin(x[4])*x[11]+Ixx*Iyy*cos(x[3])*cos(x[4])*sin(x[3])*sin(x[4])*x[11]*(1.0/2.0)-Ixx*Izz*cos(x[3])*cos(x[4])*sin(x[3])*sin(x[4])*x[11]*(1.0/2.0)+Iyy*Izz*cos(x[3])*cos(x[4])*sin(x[3])*sin(x[4])*x[11]*(1.0/2.0))/(Iyy*Izz*cos(x[4]));
		Amat(10,11) = ((Iyy*Iyy)*pow(cos(x[4]),2.0)*x[9]*(1.0/2.0)-(Iyy*Iyy)*pow(cos(x[3]),2.0)*pow(cos(x[4]),2.0)*x[9]*(1.0/2.0)+(Izz*Izz)*pow(cos(x[3]),2.0)*pow(cos(x[4]),2.0)*x[9]*(1.0/2.0)-Iyy*Izz*pow(cos(x[4]),2.0)*x[9]*(1.0/2.0)+(Iyy*Iyy)*pow(cos(x[3]),3.0)*cos(x[4])*sin(x[3])*sin(x[4])*x[10]*(1.0/2.0)+(Izz*Izz)*pow(cos(x[3]),3.0)*cos(x[4])*sin(x[3])*sin(x[4])*x[10]*(1.0/2.0)-(Iyy*Iyy)*cos(x[3])*cos(x[4])*sin(x[3])*sin(x[4])*x[10]*(1.0/2.0)-Iyy*Izz*pow(cos(x[3]),3.0)*cos(x[4])*sin(x[3])*sin(x[4])*x[10]+Ixx*Iyy*cos(x[3])*cos(x[4])*sin(x[3])*sin(x[4])*x[10]*(1.0/2.0)-Ixx*Izz*cos(x[3])*cos(x[4])*sin(x[3])*sin(x[4])*x[10]*(1.0/2.0)+Iyy*Izz*cos(x[3])*cos(x[4])*sin(x[3])*sin(x[4])*x[10]*(1.0/2.0))/(Iyy*Izz*cos(x[4]));
		Amat(11,3) = (1.0/pow(cos(x[4]),2.0)*((Iyy*Iyy)*pow(cos(x[3]),4.0)*sin(x[4])*(x[10]*x[10])-(Izz*Izz)*pow(cos(x[3]),2.0)*sin(x[4])*(x[10]*x[10])+(Izz*Izz)*pow(cos(x[3]),4.0)*sin(x[4])*(x[10]*x[10])+(Izz*Izz)*pow(sin(x[3]),2.0)*sin(x[4])*(x[10]*x[10])+Iyy*Izz*pow(cos(x[3]),2.0)*sin(x[4])*(x[10]*x[10])-Iyy*Izz*pow(cos(x[3]),4.0)*sin(x[4])*(x[10]*x[10])*2.0-Iyy*Izz*pow(sin(x[3]),2.0)*sin(x[4])*(x[10]*x[10])+Iyy*b*cos(x[3])*sin(x[3])*u[0]*4.0-Iyy*b*cos(x[3])*sin(x[3])*u[1]*4.0+Iyy*b*cos(x[3])*sin(x[3])*u[2]*4.0-Iyy*b*cos(x[3])*sin(x[3])*u[3]*4.0-Izz*b*cos(x[3])*sin(x[3])*u[0]*4.0+Izz*b*cos(x[3])*sin(x[3])*u[1]*4.0-Izz*b*cos(x[3])*sin(x[3])*u[2]*4.0+Izz*b*cos(x[3])*sin(x[3])*u[3]*4.0-(Iyy*Iyy)*pow(cos(x[3]),2.0)*pow(sin(x[3]),2.0)*sin(x[4])*(x[10]*x[10])*3.0-(Izz*Izz)*pow(cos(x[3]),2.0)*pow(sin(x[3]),2.0)*sin(x[4])*(x[10]*x[10])*3.0-(Iyy*Iyy)*pow(cos(x[3]),2.0)*pow(cos(x[4]),2.0)*x[9]*x[11]+(Izz*Izz)*pow(cos(x[3]),2.0)*pow(cos(x[4]),2.0)*x[9]*x[11]+(Iyy*Iyy)*pow(cos(x[4]),2.0)*pow(sin(x[3]),2.0)*x[9]*x[11]-(Izz*Izz)*pow(cos(x[4]),2.0)*pow(sin(x[3]),2.0)*x[9]*x[11]+Iyy*k_quad*l*pow(cos(x[3]),2.0)*cos(x[4])*u[0]*2.0-Iyy*k_quad*l*pow(cos(x[3]),2.0)*cos(x[4])*u[2]*2.0-Izz*k_quad*l*pow(cos(x[3]),2.0)*cos(x[4])*u[0]*2.0+Izz*k_quad*l*pow(cos(x[3]),2.0)*cos(x[4])*u[2]*2.0-Iyy*k_quad*l*cos(x[4])*pow(sin(x[3]),2.0)*u[0]*2.0+Iyy*k_quad*l*cos(x[4])*pow(sin(x[3]),2.0)*u[2]*2.0+Izz*k_quad*l*cos(x[4])*pow(sin(x[3]),2.0)*u[0]*2.0-Izz*k_quad*l*cos(x[4])*pow(sin(x[3]),2.0)*u[2]*2.0+(Iyy*Iyy)*cos(x[3])*cos(x[4])*sin(x[3])*x[9]*x[10]*2.0-(Izz*Izz)*cos(x[3])*cos(x[4])*sin(x[3])*x[9]*x[10]*2.0+Iyy*Izz*pow(cos(x[3]),2.0)*pow(sin(x[3]),2.0)*sin(x[4])*(x[10]*x[10])*6.0+(Iyy*Iyy)*pow(cos(x[3]),3.0)*cos(x[4])*sin(x[3])*sin(x[4])*x[10]*x[11]*4.0+(Izz*Izz)*pow(cos(x[3]),3.0)*cos(x[4])*sin(x[3])*sin(x[4])*x[10]*x[11]*4.0+Iyy*k_quad*l*cos(x[3])*sin(x[3])*sin(x[4])*u[1]*4.0-Iyy*k_quad*l*cos(x[3])*sin(x[3])*sin(x[4])*u[3]*4.0-Izz*k_quad*l*cos(x[3])*sin(x[3])*sin(x[4])*u[1]*4.0+Izz*k_quad*l*cos(x[3])*sin(x[3])*sin(x[4])*u[3]*4.0-Ixx*Iyy*cos(x[3])*cos(x[4])*sin(x[3])*x[9]*x[10]*2.0+Ixx*Izz*cos(x[3])*cos(x[4])*sin(x[3])*x[9]*x[10]*2.0-(Iyy*Iyy)*cos(x[3])*cos(x[4])*sin(x[3])*sin(x[4])*x[10]*x[11]*2.0-(Izz*Izz)*cos(x[3])*cos(x[4])*sin(x[3])*sin(x[4])*x[10]*x[11]*2.0-Iyy*Izz*pow(cos(x[3]),3.0)*cos(x[4])*sin(x[3])*sin(x[4])*x[10]*x[11]*8.0+Ixx*Iyy*cos(x[3])*cos(x[4])*sin(x[3])*sin(x[4])*x[10]*x[11]*2.0-Ixx*Izz*cos(x[3])*cos(x[4])*sin(x[3])*sin(x[4])*x[10]*x[11]*2.0+Iyy*Izz*cos(x[3])*cos(x[4])*sin(x[3])*sin(x[4])*x[10]*x[11]*4.0)*(1.0/2.0))/(Iyy*Izz);
		Amat(11,4) = (1.0/pow(cos(x[4]),2.0)*((Izz*Izz)*sin(x[4])*x[9]*x[10]-Ixx*Izz*cos(x[4]*2.0)*x[10]*x[11]+Iyy*Izz*cos(x[4]*2.0)*x[10]*x[11]*2.0+(Iyy*Iyy)*pow(cos(x[3]),3.0)*cos(x[4])*sin(x[3])*(x[10]*x[10])+(Izz*Izz)*pow(cos(x[3]),3.0)*cos(x[4])*sin(x[3])*(x[10]*x[10])-Izz*k_quad*l*cos(x[4])*u[1]*2.0+Izz*k_quad*l*cos(x[4])*u[3]*2.0+(Iyy*Iyy)*pow(cos(x[3]),2.0)*sin(x[4])*x[9]*x[10]-(Izz*Izz)*pow(cos(x[3]),2.0)*sin(x[4])*x[9]*x[10]+(Iyy*Iyy)*pow(cos(x[3]),2.0)*pow(cos(x[4]),2.0)*x[10]*x[11]-(Iyy*Iyy)*pow(cos(x[3]),4.0)*pow(cos(x[4]),2.0)*x[10]*x[11]+(Izz*Izz)*pow(cos(x[3]),2.0)*pow(cos(x[4]),2.0)*x[10]*x[11]-(Izz*Izz)*pow(cos(x[3]),4.0)*pow(cos(x[4]),2.0)*x[10]*x[11]-Ixx*Izz*sin(x[4])*x[9]*x[10]-Iyy*Izz*sin(x[4])*x[9]*x[10]-(Iyy*Iyy)*pow(cos(x[3]),2.0)*pow(sin(x[4]),2.0)*x[10]*x[11]+(Iyy*Iyy)*pow(cos(x[3]),4.0)*pow(sin(x[4]),2.0)*x[10]*x[11]-(Izz*Izz)*pow(cos(x[3]),2.0)*pow(sin(x[4]),2.0)*x[10]*x[11]+(Izz*Izz)*pow(cos(x[3]),4.0)*pow(sin(x[4]),2.0)*x[10]*x[11]-(Izz*Izz)*cos(x[3])*cos(x[4])*sin(x[3])*(x[10]*x[10])-Iyy*k_quad*l*pow(cos(x[3]),2.0)*cos(x[4])*u[1]*2.0+Iyy*k_quad*l*pow(cos(x[3]),2.0)*cos(x[4])*u[3]*2.0+Izz*k_quad*l*pow(cos(x[3]),2.0)*cos(x[4])*u[1]*2.0-Izz*k_quad*l*pow(cos(x[3]),2.0)*cos(x[4])*u[3]*2.0-Iyy*Izz*pow(cos(x[3]),3.0)*cos(x[4])*sin(x[3])*(x[10]*x[10])*2.0-Ixx*Iyy*pow(cos(x[3]),2.0)*sin(x[4])*x[9]*x[10]+Ixx*Izz*pow(cos(x[3]),2.0)*sin(x[4])*x[9]*x[10]-Ixx*Iyy*pow(cos(x[3]),2.0)*pow(cos(x[4]),2.0)*x[10]*x[11]+Ixx*Izz*pow(cos(x[3]),2.0)*pow(cos(x[4]),2.0)*x[10]*x[11]-Iyy*Izz*pow(cos(x[3]),2.0)*pow(cos(x[4]),2.0)*x[10]*x[11]*2.0+Iyy*Izz*pow(cos(x[3]),4.0)*pow(cos(x[4]),2.0)*x[10]*x[11]*2.0+Ixx*Iyy*pow(cos(x[3]),2.0)*pow(sin(x[4]),2.0)*x[10]*x[11]-Ixx*Izz*pow(cos(x[3]),2.0)*pow(sin(x[4]),2.0)*x[10]*x[11]+Iyy*Izz*pow(cos(x[3]),2.0)*pow(sin(x[4]),2.0)*x[10]*x[11]*2.0-Iyy*Izz*pow(cos(x[3]),4.0)*pow(sin(x[4]),2.0)*x[10]*x[11]*2.0+Iyy*Izz*cos(x[3])*cos(x[4])*sin(x[3])*(x[10]*x[10])-Iyy*k_quad*l*cos(x[3])*sin(x[3])*sin(x[4])*u[0]*2.0+Iyy*k_quad*l*cos(x[3])*sin(x[3])*sin(x[4])*u[2]*2.0+Izz*k_quad*l*cos(x[3])*sin(x[3])*sin(x[4])*u[0]*2.0-Izz*k_quad*l*cos(x[3])*sin(x[3])*sin(x[4])*u[2]*2.0+(Iyy*Iyy)*cos(x[3])*cos(x[4])*sin(x[3])*sin(x[4])*x[9]*x[11]*2.0-(Izz*Izz)*cos(x[3])*cos(x[4])*sin(x[3])*sin(x[4])*x[9]*x[11]*2.0)*(1.0/2.0))/(Iyy*Izz)+(1.0/pow(cos(x[4]),3.0)*sin(x[4])*(Izz*b*u[0]*-2.0+Izz*b*u[1]*2.0-Izz*b*u[2]*2.0+Izz*b*u[3]*2.0-Iyy*b*pow(cos(x[3]),2.0)*u[0]*2.0+Iyy*b*pow(cos(x[3]),2.0)*u[1]*2.0-Iyy*b*pow(cos(x[3]),2.0)*u[2]*2.0+Iyy*b*pow(cos(x[3]),2.0)*u[3]*2.0+Izz*b*pow(cos(x[3]),2.0)*u[0]*2.0-Izz*b*pow(cos(x[3]),2.0)*u[1]*2.0+Izz*b*pow(cos(x[3]),2.0)*u[2]*2.0-Izz*b*pow(cos(x[3]),2.0)*u[3]*2.0-(Izz*Izz)*cos(x[4])*x[9]*x[10]-(Izz*Izz)*cos(x[3])*sin(x[3])*sin(x[4])*(x[10]*x[10])-Ixx*Izz*sin(x[4]*2.0)*x[10]*x[11]*(1.0/2.0)+Iyy*Izz*sin(x[4]*2.0)*x[10]*x[11]+(Iyy*Iyy)*pow(cos(x[3]),3.0)*sin(x[3])*sin(x[4])*(x[10]*x[10])+(Izz*Izz)*pow(cos(x[3]),3.0)*sin(x[3])*sin(x[4])*(x[10]*x[10])-(Iyy*Iyy)*pow(cos(x[3]),2.0)*cos(x[4])*x[9]*x[10]+(Izz*Izz)*pow(cos(x[3]),2.0)*cos(x[4])*x[9]*x[10]-Izz*k_quad*l*sin(x[4])*u[1]*2.0+Izz*k_quad*l*sin(x[4])*u[3]*2.0+Ixx*Izz*cos(x[4])*x[9]*x[10]+Iyy*Izz*cos(x[4])*x[9]*x[10]-Iyy*k_quad*l*pow(cos(x[3]),2.0)*sin(x[4])*u[1]*2.0+Iyy*k_quad*l*pow(cos(x[3]),2.0)*sin(x[4])*u[3]*2.0+Izz*k_quad*l*pow(cos(x[3]),2.0)*sin(x[4])*u[1]*2.0-Izz*k_quad*l*pow(cos(x[3]),2.0)*sin(x[4])*u[3]*2.0-Iyy*Izz*pow(cos(x[3]),3.0)*sin(x[3])*sin(x[4])*(x[10]*x[10])*2.0+Ixx*Iyy*pow(cos(x[3]),2.0)*cos(x[4])*x[9]*x[10]-Ixx*Izz*pow(cos(x[3]),2.0)*cos(x[4])*x[9]*x[10]-(Iyy*Iyy)*cos(x[3])*pow(cos(x[4]),2.0)*sin(x[3])*x[9]*x[11]+(Iyy*Iyy)*pow(cos(x[3]),2.0)*cos(x[4])*sin(x[4])*x[10]*x[11]-(Iyy*Iyy)*pow(cos(x[3]),4.0)*cos(x[4])*sin(x[4])*x[10]*x[11]+(Izz*Izz)*cos(x[3])*pow(cos(x[4]),2.0)*sin(x[3])*x[9]*x[11]+(Izz*Izz)*pow(cos(x[3]),2.0)*cos(x[4])*sin(x[4])*x[10]*x[11]-(Izz*Izz)*pow(cos(x[3]),4.0)*cos(x[4])*sin(x[4])*x[10]*x[11]+Iyy*Izz*cos(x[3])*sin(x[3])*sin(x[4])*(x[10]*x[10])+Iyy*k_quad*l*cos(x[3])*cos(x[4])*sin(x[3])*u[0]*2.0-Iyy*k_quad*l*cos(x[3])*cos(x[4])*sin(x[3])*u[2]*2.0-Izz*k_quad*l*cos(x[3])*cos(x[4])*sin(x[3])*u[0]*2.0+Izz*k_quad*l*cos(x[3])*cos(x[4])*sin(x[3])*u[2]*2.0-Ixx*Iyy*pow(cos(x[3]),2.0)*cos(x[4])*sin(x[4])*x[10]*x[11]+Ixx*Izz*pow(cos(x[3]),2.0)*cos(x[4])*sin(x[4])*x[10]*x[11]-Iyy*Izz*pow(cos(x[3]),2.0)*cos(x[4])*sin(x[4])*x[10]*x[11]*2.0+Iyy*Izz*pow(cos(x[3]),4.0)*cos(x[4])*sin(x[4])*x[10]*x[11]*2.0))/(Iyy*Izz);
		Amat(11,9) = (1.0/pow(cos(x[4]),2.0)*(-(Izz*Izz)*cos(x[4])*x[10]+Ixx*Izz*cos(x[4])*x[10]+Iyy*Izz*cos(x[4])*x[10]-(Iyy*Iyy)*pow(cos(x[3]),2.0)*cos(x[4])*x[10]+(Izz*Izz)*pow(cos(x[3]),2.0)*cos(x[4])*x[10]+Ixx*Iyy*pow(cos(x[3]),2.0)*cos(x[4])*x[10]-Ixx*Izz*pow(cos(x[3]),2.0)*cos(x[4])*x[10]-(Iyy*Iyy)*cos(x[3])*pow(cos(x[4]),2.0)*sin(x[3])*x[11]+(Izz*Izz)*cos(x[3])*pow(cos(x[4]),2.0)*sin(x[3])*x[11])*(1.0/2.0))/(Iyy*Izz);
		Amat(11,10) = (1.0/pow(cos(x[4]),2.0)*(-(Izz*Izz)*cos(x[4])*x[9]+Ixx*Izz*cos(x[4])*x[9]+Iyy*Izz*cos(x[4])*x[9]-Ixx*Izz*sin(x[4]*2.0)*x[11]*(1.0/2.0)+Iyy*Izz*sin(x[4]*2.0)*x[11]-(Iyy*Iyy)*pow(cos(x[3]),2.0)*cos(x[4])*x[9]+(Izz*Izz)*pow(cos(x[3]),2.0)*cos(x[4])*x[9]+(Iyy*Iyy)*pow(cos(x[3]),3.0)*sin(x[3])*sin(x[4])*x[10]*2.0+(Izz*Izz)*pow(cos(x[3]),3.0)*sin(x[3])*sin(x[4])*x[10]*2.0+Ixx*Iyy*pow(cos(x[3]),2.0)*cos(x[4])*x[9]-Ixx*Izz*pow(cos(x[3]),2.0)*cos(x[4])*x[9]-(Izz*Izz)*cos(x[3])*sin(x[3])*sin(x[4])*x[10]*2.0+(Iyy*Iyy)*pow(cos(x[3]),2.0)*cos(x[4])*sin(x[4])*x[11]-(Iyy*Iyy)*pow(cos(x[3]),4.0)*cos(x[4])*sin(x[4])*x[11]+(Izz*Izz)*pow(cos(x[3]),2.0)*cos(x[4])*sin(x[4])*x[11]-(Izz*Izz)*pow(cos(x[3]),4.0)*cos(x[4])*sin(x[4])*x[11]+Iyy*Izz*cos(x[3])*sin(x[3])*sin(x[4])*x[10]*2.0-Ixx*Iyy*pow(cos(x[3]),2.0)*cos(x[4])*sin(x[4])*x[11]+Ixx*Izz*pow(cos(x[3]),2.0)*cos(x[4])*sin(x[4])*x[11]-Iyy*Izz*pow(cos(x[3]),2.0)*cos(x[4])*sin(x[4])*x[11]*2.0+Iyy*Izz*pow(cos(x[3]),4.0)*cos(x[4])*sin(x[4])*x[11]*2.0-Iyy*Izz*pow(cos(x[3]),3.0)*sin(x[3])*sin(x[4])*x[10]*4.0)*(1.0/2.0))/(Iyy*Izz);
		Amat(11,11) = (1.0/pow(cos(x[4]),2.0)*(Ixx*Izz*sin(x[4]*2.0)*x[10]*(1.0/2.0)-Iyy*Izz*sin(x[4]*2.0)*x[10]+(Iyy*Iyy)*cos(x[3])*pow(cos(x[4]),2.0)*sin(x[3])*x[9]-(Iyy*Iyy)*pow(cos(x[3]),2.0)*cos(x[4])*sin(x[4])*x[10]+(Iyy*Iyy)*pow(cos(x[3]),4.0)*cos(x[4])*sin(x[4])*x[10]-(Izz*Izz)*cos(x[3])*pow(cos(x[4]),2.0)*sin(x[3])*x[9]-(Izz*Izz)*pow(cos(x[3]),2.0)*cos(x[4])*sin(x[4])*x[10]+(Izz*Izz)*pow(cos(x[3]),4.0)*cos(x[4])*sin(x[4])*x[10]+Ixx*Iyy*pow(cos(x[3]),2.0)*cos(x[4])*sin(x[4])*x[10]-Ixx*Izz*pow(cos(x[3]),2.0)*cos(x[4])*sin(x[4])*x[10]+Iyy*Izz*pow(cos(x[3]),2.0)*cos(x[4])*sin(x[4])*x[10]*2.0-Iyy*Izz*pow(cos(x[3]),4.0)*cos(x[4])*sin(x[4])*x[10]*2.0)*(-1.0/2.0))/(Iyy*Izz);

		
    }

    void B( const state_type & x, const state_type & /*u*/, 
	    Eigen::Matrix< double, xlen, ulen > & Bmat ) {
		
		Bmat(6,0) = (k_quad*(sin(x[3])*sin(x[5])+cos(x[3])*cos(x[5])*sin(x[4])))/m;
		Bmat(6,1) = (k_quad*(sin(x[3])*sin(x[5])+cos(x[3])*cos(x[5])*sin(x[4])))/m;
		Bmat(6,2) = (k_quad*(sin(x[3])*sin(x[5])+cos(x[3])*cos(x[5])*sin(x[4])))/m;
		Bmat(6,3) = (k_quad*(sin(x[3])*sin(x[5])+cos(x[3])*cos(x[5])*sin(x[4])))/m;
		Bmat(7,0) = -(k_quad*(cos(x[5])*sin(x[3])-cos(x[3])*sin(x[4])*sin(x[5])))/m;
		Bmat(7,1) = -(k_quad*(cos(x[5])*sin(x[3])-cos(x[3])*sin(x[4])*sin(x[5])))/m;
		Bmat(7,2) = -(k_quad*(cos(x[5])*sin(x[3])-cos(x[3])*sin(x[4])*sin(x[5])))/m;
		Bmat(7,3) = -(k_quad*(cos(x[5])*sin(x[3])-cos(x[3])*sin(x[4])*sin(x[5])))/m;
		Bmat(8,0) = (k_quad*cos(x[3])*cos(x[4]))/m;
		Bmat(8,1) = (k_quad*cos(x[3])*cos(x[4]))/m;
		Bmat(8,2) = (k_quad*cos(x[3])*cos(x[4]))/m;
		Bmat(8,3) = (k_quad*cos(x[3])*cos(x[4]))/m;
		Bmat(9,0) = (b*sin(x[4])*(Iyy-Iyy*pow(sin(x[3]),2.0)+Izz*pow(sin(x[3]),2.0)))/(Iyy*Izz*(pow(sin(x[4]),2.0)-1.0))+(k_quad*l*sin(x[4])*sin(x[3]*2.0)*(Iyy*(1.0/2.0)-Izz*(1.0/2.0)))/(Iyy*Izz*cos(x[4]));
		Bmat(9,1) = -(b*sin(x[4])*(Iyy-Iyy*pow(sin(x[3]),2.0)+Izz*pow(sin(x[3]),2.0)))/(Iyy*Izz*(pow(sin(x[4]),2.0)-1.0))+(k_quad*l*(Iyy*Izz+Ixx*Iyy*pow(sin(x[4]),2.0)-Iyy*Izz*pow(sin(x[4]),2.0)-Ixx*Iyy*pow(sin(x[3]),2.0)*pow(sin(x[4]),2.0)+Ixx*Izz*pow(sin(x[3]),2.0)*pow(sin(x[4]),2.0)))/(Ixx*Iyy*Izz*(pow(sin(x[4]),2.0)-1.0));
		Bmat(9,2) = (b*sin(x[4])*(Iyy-Iyy*pow(sin(x[3]),2.0)+Izz*pow(sin(x[3]),2.0)))/(Iyy*Izz*(pow(sin(x[4]),2.0)-1.0))-(k_quad*l*sin(x[4])*sin(x[3]*2.0)*(Iyy*(1.0/2.0)-Izz*(1.0/2.0)))/(Iyy*Izz*cos(x[4]));
		Bmat(9,3) = -(b*sin(x[4])*(Iyy-Iyy*pow(sin(x[3]),2.0)+Izz*pow(sin(x[3]),2.0)))/(Iyy*Izz*(pow(sin(x[4]),2.0)-1.0))-(k_quad*l*(Iyy*Izz+Ixx*Iyy*pow(sin(x[4]),2.0)-Iyy*Izz*pow(sin(x[4]),2.0)-Ixx*Iyy*pow(sin(x[3]),2.0)*pow(sin(x[4]),2.0)+Ixx*Izz*pow(sin(x[3]),2.0)*pow(sin(x[4]),2.0)))/(Ixx*Iyy*Izz*(pow(sin(x[4]),2.0)-1.0));
		Bmat(10,0) = (Iyy*b*sin(x[3]*2.0)*(1.0/2.0)-Izz*b*sin(x[3]*2.0)*(1.0/2.0)-Iyy*k_quad*l*cos(x[4])+Iyy*k_quad*l*pow(cos(x[3]),2.0)*cos(x[4])-Izz*k_quad*l*pow(cos(x[3]),2.0)*cos(x[4]))/(Iyy*Izz*cos(x[4]));
		Bmat(10,1) = (Iyy*b*sin(x[3]*2.0)*(-1.0/2.0)+Izz*b*sin(x[3]*2.0)*(1.0/2.0)+Iyy*k_quad*l*cos(x[3])*sin(x[3])*sin(x[4])-Izz*k_quad*l*cos(x[3])*sin(x[3])*sin(x[4]))/(Iyy*Izz*cos(x[4]));
		Bmat(10,2) = (Iyy*b*sin(x[3]*2.0)*(1.0/2.0)-Izz*b*sin(x[3]*2.0)*(1.0/2.0)+Iyy*k_quad*l*cos(x[4])-Iyy*k_quad*l*pow(cos(x[3]),2.0)*cos(x[4])+Izz*k_quad*l*pow(cos(x[3]),2.0)*cos(x[4]))/(Iyy*Izz*cos(x[4]));
		Bmat(10,3) = (Iyy*b*sin(x[3]*2.0)*(-1.0/2.0)+Izz*b*sin(x[3]*2.0)*(1.0/2.0)-Iyy*k_quad*l*cos(x[3])*sin(x[3])*sin(x[4])+Izz*k_quad*l*cos(x[3])*sin(x[3])*sin(x[4]))/(Iyy*Izz*cos(x[4]));
		Bmat(11,0) = (1.0/pow(cos(x[4]),2.0)*(Izz*b*2.0+Iyy*b*pow(cos(x[3]),2.0)*2.0-Izz*b*pow(cos(x[3]),2.0)*2.0-Iyy*k_quad*l*cos(x[3])*cos(x[4])*sin(x[3])*2.0+Izz*k_quad*l*cos(x[3])*cos(x[4])*sin(x[3])*2.0)*(-1.0/2.0))/(Iyy*Izz);
		Bmat(11,1) = (1.0/pow(cos(x[4]),2.0)*(Izz*b*2.0+Iyy*b*pow(cos(x[3]),2.0)*2.0-Izz*b*pow(cos(x[3]),2.0)*2.0-Izz*k_quad*l*sin(x[4])*2.0-Iyy*k_quad*l*pow(cos(x[3]),2.0)*sin(x[4])*2.0+Izz*k_quad*l*pow(cos(x[3]),2.0)*sin(x[4])*2.0)*(1.0/2.0))/(Iyy*Izz);
		Bmat(11,2) = (1.0/pow(cos(x[4]),2.0)*(Izz*b*2.0+Iyy*b*pow(cos(x[3]),2.0)*2.0-Izz*b*pow(cos(x[3]),2.0)*2.0+Iyy*k_quad*l*cos(x[3])*cos(x[4])*sin(x[3])*2.0-Izz*k_quad*l*cos(x[3])*cos(x[4])*sin(x[3])*2.0)*(-1.0/2.0))/(Iyy*Izz);
		Bmat(11,3) = (1.0/pow(cos(x[4]),2.0)*(Izz*b*2.0+Iyy*b*pow(cos(x[3]),2.0)*2.0-Izz*b*pow(cos(x[3]),2.0)*2.0+Izz*k_quad*l*sin(x[4])*2.0+Iyy*k_quad*l*pow(cos(x[3]),2.0)*sin(x[4])*2.0-Izz*k_quad*l*pow(cos(x[3]),2.0)*sin(x[4])*2.0)*(1.0/2.0))/(Iyy*Izz);

    }
  };
  //]

}

#endif  // SYS_LIN_HPP








 


